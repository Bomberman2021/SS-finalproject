{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\UserInfo.ts"],"names":[],"mappings":";;;;AAAA,6CAA6C;;AAEvC,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAyB,CAAC;AAG1C;IAA8B,4BAAY;IAD1C;QAAA,qEAqEC;QAjEC,cAAQ,GAAa,IAAI,CAAC;QAG1B,eAAS,GAAa,IAAI,CAAC;QAG3B,cAAQ,GAAa,IAAI,CAAC;QAEnB,iBAAW,GAAY,KAAK,CAAC;QAE7B,YAAM,GAAW,EAAE,CAAC;;QAsD3B,iBAAiB;IACnB,CAAC;IArDC,wBAAwB;IAExB,yBAAM,GAAN;QACE,IAAM,IAAI,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,WAAW,CAAC;QACzC,IAAI,IAAI,EAAE;YACR,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC7B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC;SACxB;aAAM;YACL,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SACzB;QAED,gCAAgC;QAChC,0DAA0D;QAC1D,wDAAwD;QACxD,IAAI;IACN,CAAC;IAED,wBAAK,GAAL;IACA,CAAC;IAED,gCAAa,GAAb,UAAc,MAAM;QAApB,iBAgBC;QAfC,IAAM,WAAW,GAAG,yBAAuB,MAAQ,CAAC;QACpD,QAAQ,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC;aACjD,IAAI,CAAC,UAAC,QAAQ;YACb,kDAAkD;YAElD,IAAM,OAAO,GAAG,QAAQ,CAAC,GAAG,EAAE,CAAC;YAE/B,IAAG,KAAI,CAAC,QAAQ,EAAC,KAAI,CAAC,SAAS,EAAC,KAAI,CAAC,QAAQ,EAAC;gBAC5C,KAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;gBAClD,KAAI,CAAC,SAAS,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC;gBACtC,KAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC;aACrC;QAEH,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,CAAC,IAAK,OAAA,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,OAAO,CAAC,EAAxB,CAAwB,CAAC,CAAC;IAC1C,CAAC;IAED,2BAAQ,GAAR;QACE,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;QACxB,IAAM,WAAW,GAAG,yBAAuB,IAAI,CAAC,MAAQ,CAAC;QAEzD,IAAM,IAAI,GAAG;QACX,2CAA2C;SAC5C,CAAC;QACF,QAAQ,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACpD,CAAC;IA1DD;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;8CACO;IAG1B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;+CACQ;IAG3B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;8CACO;IATf,QAAQ;QADpB,OAAO;OACK,QAAQ,CAoEpB;IAAD,eAAC;CApED,AAoEC,CApE6B,EAAE,CAAC,SAAS,GAoEzC;AApEY,4BAAQ","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// import LoadSceneBtn from \"./LoadSceneBtn\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport class UserInfo extends cc.Component {\r\n\r\n  @property(cc.Label)\r\n  userName: cc.Label = null;\r\n\r\n  @property(cc.Label)\r\n  userLevel: cc.Label = null;\r\n\r\n  @property(cc.Label)\r\n  userCoin: cc.Label = null;\r\n\r\n  public player2Mode: boolean = false;\r\n\r\n  public userId: String = '';\r\n\r\n  // LIFE-CYCLE CALLBACKS:\r\n\r\n  onLoad () {    \r\n    const user = firebase.auth().currentUser;\r\n    if (user) {\r\n      this.getUserRecord(user.uid);\r\n      this.userId = user.uid;\r\n    } else {\r\n      console.log('不對不對喔沒登入');\r\n    }\r\n\r\n    // if (this.player2Mode) {      \r\n    //   this.mode.getComponent('player2Block').active = true;\r\n    //   this.mode.getComponent('modeBlock').active = false;\r\n    // }\r\n  }\r\n\r\n  start () {\r\n  }\r\n\r\n  getUserRecord(userId) {\r\n    const playersInfo = `/players/playerInfo-${userId}`;\r\n    firebase.database().ref(playersInfo).once('value')\r\n    .then((snapshot) => {\r\n      // console.log('snapshot.val():', snapshot.val());\r\n      \r\n      const theData = snapshot.val();\r\n\r\n      if(this.userName,this.userLevel,this.userCoin){\r\n        this.userName.string = theData.name.toUpperCase();\r\n        this.userLevel.string = theData.level;\r\n        this.userCoin.string = theData.coin;\r\n      }         \r\n      \r\n    })\r\n    .catch((e) => console.error(e.message));\r\n  }\r\n\r\n  saveData() {\r\n    console.log('saveData');\r\n    const playersInfo = `/players/playerInfo-${this.userId}`;\r\n    \r\n    const data = {\r\n      // userCoin:  Number(this.userCoin.string),\r\n    };\r\n    firebase.database().ref(playersInfo).update(data);\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  // update (dt) {}\r\n}\r\n"]}